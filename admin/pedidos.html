<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Pedidos | RD Distribuidora</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
.container {
  max-width:1200px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}
h1 {
  color:#ff7a00;
}
table {
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
}
th, td {
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:center;
  font-size:14px;
}
th {
  background:#ff7a00;
  color:#fff;
}
.badge {
  padding:4px 8px;
  border-radius:4px;
  font-size:12px;
  color:#fff;
}
.pix { background:#0d6efd; }
.dinheiro { background:#198754; }
.cartao { background:#6f42c1; }
.outros { background:#6c757d; }

button {
  padding:6px 10px;
  border:none;
  border-radius:4px;
  cursor:pointer;
}
.imprimir {
  background:#198754;
  color:#fff;
}
</style>
</head>

<body>

<div class="container">
  <h1>üìã Pedidos Pendentes</h1>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Data / Hora</th>
        <th>Entrega</th>
        <th>Casa</th>
        <th>Pagamento</th>
        <th>Total</th>
        <th>A√ß√£o</th>
      </tr>
    </thead>
    <tbody id="lista"></tbody>
  </table>
</div>

<script>
async function carregarPedidos() {
  const res = await fetch('/admin/pedidos');
  const pedidos = await res.json();
  const tbody = document.getElementById('lista');
  tbody.innerHTML = '';

  pedidos.forEach(p => {
    const pagamentoClasse =
      p.pagamento === 'Pix' ? 'pix' :
      p.pagamento === 'Dinheiro' ? 'dinheiro' :
      p.pagamento === 'Cartao' ? 'cartao' : 'outros';

    const entrega = p.condominio && p.condominio !== 'Outros'
      ? `üè¢ ${p.condominio}`
      : `üìç ${p.outros || 'Outro local'}`;

    const troco = p.pagamento === 'Dinheiro' && p.troco
      ? `<br><small>Troco: R$ ${Number(p.troco).toFixed(2)}</small>`
      : '';

    tbody.innerHTML += `
      <tr>
        <td>#${p.id}</td>
        <td>${p.data}</td>
        <td>${entrega}</td>
        <td>${p.casa || '-'}</td>
        <td>
          <span class="badge ${pagamentoClasse}">
            ${p.pagamento}
          </span>
          ${troco}
        </td>
        <td><strong>R$ ${Number(p.total).toFixed(2)}</strong></td>
        <td>
          <button class="imprimir" onclick="imprimir(${p.id})">
            üñ®Ô∏è Imprimir
          </button>
        </td>
      </tr>
    `;
  });
}

function imprimir(id) {
  window.open(
    `/admin/pedidos/${id}/print`,
    '_blank',
    'width=300,height=600'
  );
}

carregarPedidos();
</script>

</body>
</html>
