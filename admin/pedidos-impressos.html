<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Pedidos Impressos | RD Distribuidora</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="admin.css">
</head>
<body>

<header class="header">
  <div>
    <h1>Pedidos Impressos</h1>
    <span class="sub">RD Distribuidora</span>
  </div>
  <nav>
    <a href="dashboard.html">ğŸ“Š Dashboard</a>
    <a href="pedidos.html">ğŸ“¦ Pendentes</a>
  </nav>
</header>

<main class="content" id="lista"></main>

<script>
fetch('/admin/pedidos-impressos')
  .then(res => res.json())
  .then(pedidos => {
    const lista = document.getElementById('lista');

    if (!pedidos.length) {
      lista.innerHTML = '<div class="vazio">Nenhum pedido impresso</div>';
      return;
    }

    pedidos.forEach(p => {
      const div = document.createElement('div');
      div.className = 'pedido-card';

      div.innerHTML = `
        <div class="top">
          <span class="numero">#${p.id}</span>
          <span class="status impresso">IMPRESSO</span>
        </div>

        <div class="info">
          <p><b>Data:</b> ${p.data}</p>
          <p><b>CondomÃ­nio:</b> ${p.condominio}</p>
          <p><b>Casa:</b> ${p.casa || '-'}</p>
          <p><b>Pagamento:</b> ${p.pagamento}</p>
        </div>

        <div class="footer">
          <span class="total">R$ ${p.total.toFixed(2)}</span>
          <div class="acoes">
            <a href="/admin/pedidos/${p.id}/pdf" target="_blank">ğŸ“„ PDF</a>
            <button onclick="reimprimir(${p.id})">ğŸ–¨ï¸ Reimprimir</button>
          </div>
        </div>
      `;

      lista.appendChild(div);
    });
  });

function reimprimir(id){
  fetch(`/admin/pedidos/${id}/imprimir`, { method:'POST' })
    .then(() => alert('Pedido reimpresso com sucesso'));
}
</script>

</body>
</html>
